SELECT
IPTSUMOPRT.AN
-- , IPTSUMOPRT.ITEMNO
, IPTSUMOPRT.ICD9CM
, ICD9CM.NAME AS PROC_NAME
, CASE
    WHEN IPTSUMOPRT.ORFLAG = 1 THEN 'Y'
    ELSE 'N'
    END AS USE_OR
, DATEADD(SECOND, CAST(IPTSUMOPRT.INTIME AS INT) % 100, 
    DATEADD(MINUTE, (CAST(IPTSUMOPRT.INTIME AS INT) / 100) % 100, 
        DATEADD(HOUR, CAST(IPTSUMOPRT.INTIME AS INT) / 10000, IPTSUMOPRT.INDATE)
    )
) AS INDATETIME
, DATEADD(SECOND, CAST(IPTSUMOPRT.OUTTIME AS INT) % 100, 
    DATEADD(MINUTE, (CAST(IPTSUMOPRT.OUTTIME AS INT) / 100) % 100, 
        DATEADD(HOUR, CAST(IPTSUMOPRT.OUTTIME AS INT) / 10000, IPTSUMOPRT.OUTDATE)
    )
) AS OUTDATETIME
-- , IPTSUMOPRT.FIRSTDATE
FROM {{ source('ddc_internal', 'IPTSUMOPRT') }} IPTSUMOPRT
LEFT JOIN {{ source('ddc_internal', 'ICD9CM') }} ICD9CM ON ICD9CM.ICD9CM = IPTSUMOPRT.ICD9CM
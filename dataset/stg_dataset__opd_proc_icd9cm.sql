SELECT
PTICD9CM.HN
, DATEADD(SECOND, CAST(PTICD9CM.VSTTIME AS INT) % 100, 
    DATEADD(MINUTE, (CAST(PTICD9CM.VSTTIME AS INT) / 100) % 100, 
        DATEADD(HOUR, CAST(PTICD9CM.VSTTIME AS INT) / 10000, PTICD9CM.VSTDATE)
    )
) AS VSTDATETIME
, PTICD9CM.CLINICLCT
, LCT.DSPNAME
, LCT.HCODE
, PTICD9CM.ITEMNO
, PTICD9CM.AN
, PTICD9CM.VN
, PTICD9CM.ICD9CM
, ICD9CM.NAME AS PROC_NAME
, PTICD9CM.FIRSTDATE
FROM {{ source('ddc_internal', 'PTICD9CM') }} PTICD9CM
LEFT JOIN {{ source('ddc_internal', 'ICD9CM') }} ICD9CM ON ICD9CM.ICD9CM = PTICD9CM.ICD9CM
LEFT JOIN {{ source('ddc_internal', 'LCT') }} LCT ON LCT.LCT = PTICD9CM.CLINICLCT